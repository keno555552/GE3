#pragma once
#include "../mathsUnit/Vector3.h"

const static int permutation[]{ 151,160,137,91,90,15,						   // Hash lookup table as defined by Ken Perlin.  This is a randomly
131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,    // arranged array of all numbers from 0-255 inclusive.
 88,237,149,56,87,174,20,125,136,171,168, 68,175,74,165,71,134,139,48,27,166,
77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,
102,143,54, 65,25,63,161, 1,216,80,73,209,76,132,187,208, 89,18,169,200,196,
135,130,116,188,159,86,164,100,109,198,173,186, 3,64,52,217,226,250,124,123,
5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,
223,183,170,213,119,248,152, 2,44,154,163, 70,221,153,101,155,167, 43,172,9,
129,22,39,253, 19,98,108,110,79,113,224,232,178,185, 112,104,218,246,97,228,
251,34,242,193,238,210,144,12,191,179,162,241, 81,51,145,235,249,14,239,107,
49,192,214, 31,181,199,106,157,184, 84,204,176,115,121,50,45,127, 4,150,254,
138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180
    ,93, 12, 237, 189, 45, 182, 27, 156, 249, 76, 103, 198, 140, 222, 4, 121,
    87, 34, 211, 96, 205, 147, 170, 64, 110, 202, 249, 129, 52, 181, 35, 246,
    15, 67, 224, 104, 91, 143, 188, 175, 226, 56, 39, 172, 255, 79, 162, 11,
    217, 146, 230, 193, 152, 7, 169, 119, 243, 83, 74, 232, 100, 154, 178, 220,
    58, 133, 248, 41, 77, 195, 199, 38, 116, 151, 29, 207, 185, 106, 238, 132,
    214, 120, 223, 166, 50, 144, 213, 98, 235, 62, 136, 250, 95, 8, 134, 228,
    30, 227, 214, 3, 184, 126, 99, 242, 61, 212, 157, 55, 107, 168, 191, 209,
    176, 85, 71, 253, 139, 46, 31, 112, 94, 239, 221, 109, 49, 125, 24, 210,
    18, 122, 245, 53, 248, 81, 167, 203, 66, 178, 177, 41, 150, 197, 80, 20,
    165, 23, 55, 154, 206, 47, 229, 63, 132, 192, 116, 26, 84, 237, 72, 145,
    190, 90, 92, 244, 240, 204, 130, 135, 60, 115, 143, 102, 231, 221, 43, 174,
    59, 114, 233, 9, 99, 216, 70, 88, 111, 158, 6, 219, 179, 142, 195, 138,
    97, 250, 204, 124, 32, 247, 20, 240, 128, 207, 141, 19, 33, 182, 174, 202,
    163, 44, 59, 25, 89, 194, 15, 77, 108, 160, 105, 234, 42, 235, 156, 127,
    183, 37, 123, 51, 173, 36, 149, 68, 129, 101, 118, 16, 69, 48, 215, 187,
    208, 165, 117, 170, 153, 113, 93, 222, 86, 232, 1, 14, 192, 137, 5, 75
};

class PerlinNoise
{
public:
	PerlinNoise();

    void SetSeed(int seed);

	int inc(int num);
	
	float grad(int hash, Vector3 target);

	float lerp(float a, float b, float x);

    int scrambledIndex(int index);

	float perlin(Vector3 target);

    /// fractional Brownian motion
    float fBm(Vector3 pos, int octaves, float persistence, float amplitude = 1.0f, float frequency = 1.0f );

	bool SetRepeat(int repeat);

private:
	int p[512];
	int repeat_ = 0;
    int seed_ = 0;
};
